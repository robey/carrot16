<!DOCTYPE html>
<html>
  <head>
    <title>DCPU-16 emulator</title>
    <script type="text/javascript" src="js/jquery-1.8.3.js"></script>
    <script type="text/javascript" src="js/d16asm.js"></script>
    <script type="text/javascript" src="js/emulator.js"></script>
    <script type="text/javascript" src="lib/carrot16/ui.js"></script>

<!--
    <script type="text/javascript" src="js/disassembler.js?v=1"></script>
    <script type="text/javascript" src="js/clock.js?v=2"></script>
    <script type="text/javascript" src="js/keyboard.js?v=1"></script>
  -->
    <link rel="stylesheet" href="css/bootstrap-2.2.2.css">
    <link rel="stylesheet" href="css/carrot16.css">
  </head>
  <body>
    <div id="header">
      <img src="images/carrot16.jpg" class="header_image">
    </div>

    <div class="noscroll" id="body">
      <div class="row-fluid main noscroll" id="box">
        <div class="span8 noscroll" id="left_panel">
          <div class="row-fluid" id="tab_row">
            <div class="span1 tab_spacer"></div>
            <div class="span7 tabs">
              <a onclick="toggleTab(0)" class="tab pointer tab_active" id="tab0">Assembler</a>
              <a onclick="toggleTab(1)" class="tab pointer tab_inactive" id="tab1">Disassembler</a>
              <a onclick="toggleTab(2)" class="tab pointer tab_inactive" id="tab2">Memory Dump</a>
            </div>
            <div class="span4"></div>
          </div>
          <div class="row-fluid tab_content" id="tab0_content">
            <div class="span1 mono pointer linenums">
              <div>
                <span id="line_highlight"></span>
              </div>
              <div id="linenums">
                <span class="linenum" id="ln1">1</span>
                <span class="linenum breakpoint" id="ln2">2</span>
                <span class="linenum" id="ln3">3</span>
              </div>
            </div>
            <div class="span7 editor_div" id="codebox">
              <textarea class="mono editor" id="code" oninput="codeEdited()" onchange="codeChanged()" wrap=off spellcheck="false">
set a, 0
set b, 0x80
hwi 0
set a, 3
set b, 1
hwi 0
set a, 5
set b, 0x200
hwi 0
set [0x200], 0x666
set a, 2
set b, 0x200
hwi 0
:go
set [0x80], 0xe068
set [0x81], 0xc069
set [0x82], 0x8007
set [0x83], [0x80]
set [0xa0], 0xe0d2
set [0xa1], 0xe0cf
set [0xa2], 0xe0c2
set [0xa3], 0xe0c5
set [0xa4], 0xe0d9
jmp go
SUB PC, 1
</textarea>
            </div>
            <div class="span1 mono linenums addr" id="offsets">
            </div>
            <div class="span3 mono dump" id="dump">
            </div>
          </div>
          <div class="row-fluid tab_content" id="tab1_content">
            <div class="span1 mono linenums">
            </div>
            <div class="span4 editor_div">
              <textarea class="mono editor" id="da_input" onkeyup="disassemble()" onchange="disassemble()" wrap=off spellcheck="false">
              </textarea>
            </div>
            <div class="span1 mono linenums addr" id="da_lines">
            </div>
            <div class="span6 mono dump" id="da_code">
            </div>
          </div>
          <div class="row-fluid tab_content" id="tab2_content" onscroll="updateMemoryView()">
            <div id="memory_view">
              <div class="span1 mono linenums" id="memory_lines">
              </div>
              <div class="span7 mono editor_div" id="memory_dump">
              </div>
              <div class="span1 mono linenums addr" id="memory_unused">
              </div>
              <div class="span3 mono dump" id="memory_code">
              </div>
            </div>
          </div>
        </div>
        <div class="span4 noscroll" id="panel_right">
          <div class="screen_frame">
            <canvas id="screen" width="384" height="288"></canvas>
            <img id="loading_overlay" src="images/nya-elek.png" width="384" height="288" />
            <img id="static_overlay" src="images/static.gif" width="384" height="288" />

            <div class="notice">Keyboard input is available while the program is running.</div>
            <div class="row-fluid buttons">
              <div class="span4">
                <button onclick="run()" id="button_run">&#8595; Run (F5)</button>
              </div>
              <div class="span4">
                <button onclick="step()">&#8618; Step (F6)</button>
              </div>
              <div class="span4">
                <button onclick="reset()">&#8634; Reset (F4)</button><br/>
              </div>
            </div>
          </div>

          <div class="registers">
            <table border=0 class="mono">
              <tr>
                <td class="reg_name">PC</td><td id="regPC" class="r_pc">0</td>
                <td class="reg_name">SP</td><td id="regSP" class="r_sp">0</td>
                <td class="reg_name">IA</td><td id="regIA" class="r_ia">0</td>
                <td rowspan=5 id="cpu_heat_box">
                  <canvas id="cpu_heat" height="100" width="1"></canvas>
                </td>
              </tr>
              <tr>
                <td class="reg_name">A</td><td id="regA">0</td>
                <td class="reg_name">B</td><td id="regB">0</td>
                <td class="reg_name">C</td><td id="regC">0</td>
              </tr>
              <tr>
                <td class="reg_name">X</td><td id="regX">0</td>
                <td class="reg_name">Y</td><td id="regY">0</td>
                <td class="reg_name">Z</td><td id="regZ">0</td>
              </tr>
              <tr>
                <td class="reg_name">I</td><td id="regI">0</td>
                <td class="reg_name">J</td><td id="regJ">0</td>
                <td class="reg_name"></td>
              </tr>
              <tr>
                <td class="reg_name">EX</td><td id="regEX">0</td>
                <td colspan=4 class="cycles"><span id="cycles">0</span> cycles</td>
              </tr>
            </table>
          </div>

          <!-- get rid of this -->
          <div class="row-fluid">
            <button onclick="disassembleDump()" id="disassemble">Disassemble</button>
          </div>
        </div>
      </div>
      <div class="row-fluid log_frame" id="log_frame">
        <div class="span12" id="log">
        </div>
      </div>
    </div>
  </body>
</html>
